<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="../_app/immutable/assets/0.ULhG9gpl.css" rel="stylesheet">
		<link href="../_app/immutable/assets/Toaster.Dljj2rV8.css" rel="stylesheet">
		<link href="../_app/immutable/assets/3.BJlDkOpa.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.Ckx-DEvp.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/entry.Ie7rGrFD.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/runtime.BAFUM52B.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/control.CYgJF_JY.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.HqDmpUJI.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/preload-helper.D6kgxu3v.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/disclose-version.Bedei8AD.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index-client.KQq4m8LZ.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/svelte-component.DMSORSFP.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.ChhUFNes.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Toaster.svelte_svelte_type_style_lang.BmHREJqO.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/store.9yGI1nh7.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/attributes.D0NGgthW.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index.DWgPtC_I.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/stores.B8GNZjuf.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/3.DJF7piDy.js"><!--[--><!--[--><!--]!--> <!--[--><script nonce="%sveltekit.nonce%">(function setInitialMode(defaultMode, themeColors2) {
  const rootEl = document.documentElement;
  const mode = localStorage.getItem("mode-watcher-mode") || defaultMode;
  const light = mode === "light" || mode === "system" && window.matchMedia("(prefers-color-scheme: light)").matches;
  rootEl.classList[light ? "remove" : "add"]("dark");
  rootEl.style.colorScheme = light ? "light" : "dark";
  if (themeColors2) {
    const themeMetaEl = document.querySelector('meta[name="theme-color"]');
    if (themeMetaEl) {
      themeMetaEl.setAttribute("content", mode === "light" ? themeColors2.light : themeColors2.dark);
    }
  }
  localStorage.setItem("mode-watcher-mode", mode);
})("system");</script><!--]--><!--]--><!--[--><meta property="og:type" content="article"> <meta property="og:title" content="OAuth"><!--]--><title>OAuth</title>
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents"><!--[--><!--[--><!--[--><!--[--><!--]--> <!--[--><!--[--><!--]!--><!--]--> <!--[--><header class="sticky top-0 z-50 overflow-x-hidden border-b border-border bg-background/75 backdrop-blur-md"><div class="container px-4"><div class="flex h-[70px] items-center justify-between gap-3"><div class="flex items-center gap-1.5"><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><button  type="button" tabindex="0" aria-haspopup="dialog" aria-expanded="false" data-melt-dialog-trigger="" data-dialog-trigger="" class="inline-flex items-center justify-center whitespace-nowrap rounded-md font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:text-accent-foreground h-10 py-2 mr-2 px-0 text-base hover:bg-transparent focus-visible:bg-transparent focus-visible:ring-0 focus-visible:ring-offset-0 md:hidden" data-button-root=""><!--[--><!--[--><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-menu h-5 w-5"><!--[--><!--[--><!--[--><line  x1="4" x2="20" y1="12" y2="12"><!--[--><!--]--></line><!--]--><!--]--><!--[--><!--[--><line  x1="4" x2="20" y1="6" y2="6"><!--[--><!--]--></line><!--]--><!--]--><!--[--><!--[--><line  x1="4" x2="20" y1="18" y2="18"><!--[--><!--]--></line><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--> <span class="sr-only">Toggle Menu</span><!--]--><!--]--><!--]--></button><!--]--><!--]--><!--]--><!--]--><!--]--><!--]--><!--]--> <!--[--><!--[--><!--[--><!--[--><div data-portal="" data-melt-dialog-portalled="" data-dialog-portal=""><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--]!--><!--]!--><!--]!--><!--]!--><!--]!--><!--]!--><!--]--><!--]--> <!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--]!--><!--]!--><!--]!--><!--]!--><!--]!--><!--]!--><!--]--><!--]--><!--]--></div><!--]!--><!--]--><!--]--><!--]--><!--]--><!--]--><!--]--> <a href="/" class="ml-2 rounded-md font-quicksand focus-visible:outline-none text-xl font-bold focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background">The Copenhagen Book</a></div> <div class="flex items-center justify-end gap-2.5"><!--[--><!--[--><!--[--><!--[--><button  type="button" tabindex="0" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-10 w-10" data-button-root=""><!--[--><!--[--><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-sun h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"><!--[--><!--[--><!--[--><circle  cx="12" cy="12" r="4"><!--[--><!--]--></circle><!--]--><!--]--><!--[--><!--[--><path  d="M12 2v2"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="M12 20v2"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="m4.93 4.93 1.41 1.41"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="m17.66 17.66 1.41 1.41"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="M2 12h2"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="M20 12h2"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="m6.34 17.66-1.41 1.41"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="m19.07 4.93-1.41 1.41"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--> <!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-moon absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"><!--[--><!--[--><!--[--><path  d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--> <span class="sr-only">Change theme</span><!--]--><!--]--><!--]--></button><!--]--><!--]!--><!--]--><!--]--></div></div></div></header><!--]--> <div class="min-h-[calc(100vh-64px)]"><div class="container flex-1 items-start md:grid md:grid-cols-[220px_minmax(0,1fr)] md:gap-6 lg:grid-cols-[250px_minmax(0,1fr)] lg:gap-10"><!--[--><!--[--><aside class="fixed top-10 z-30 hidden h-[calc(100vh-3.5rem)] w-full shrink-0 overflow-y-auto border-r border-border md:sticky md:block"><div class="h-full py-6 pr-4 lg:py-8"><nav class="space-y-3"><div class="flex w-full flex-col pb-[50px]"><!--[--><!--[--><!--[--><!--[--><!--[--><div class="grid grid-flow-row auto-rows-max gap-0.5 pb-2 pl-4 text-sm"><!--[--><!--[--><!--[--><a href="/content/index" class="group flex w-full items-center gap-2.5 rounded-md px-2.5 py-1.5 text-sm font-semibold text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Introduction <!--[--><!--]!--></a><!--]--><!--]--><!--]--></div><!--]--><!--]--><!--]--><!--]--><!--[--><!--[--><div class="pb-4"><h4 class="mb-1 ml-[9px] rounded-md px-2.5 py-2 pl-4 text-xs font-medium uppercase text-muted-foreground">content</h4> <!--[--><!--[--><!--[--><div class="grid grid-flow-row auto-rows-max gap-0.5 pl-4 text-sm"><!--[--><!--[--><!--[--><a href="/content/server-side-tokens" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Server-side tokens <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/sessions" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Sessions <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/password-authentication" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Password authentication <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/email-verification" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Email verification <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/password-reset" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Password reset <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/random-values" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Generating random values <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/oauth" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background text-blue-600 dark:text-blue-500" target="" rel="">OAuth <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/mfa" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Multi-factor authentication (MFA) <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/passkeys" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Passkeys <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/csrf" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Cross-site request forgery (CSRF) <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/open-redirect" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Open redirect <!--[--><!--]!--></a><!--]--><!--]--><!--]--></div><!--]--><!--]--><!--]--></div><!--]!--><!--]--><!--]--></div></nav></div></aside><!--]--><!--]--> <main class="relative pb-6 pl-4 pr-4 pt-16 md:pl-0 lg:gap-10 xl:grid-cols-[1fr_220px] xl:grid"><div class="mx-auto w-full min-w-0 md:max-w-[700px]" id="content"><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><h1 class="mt-2 scroll-m-20 text-4xl font-bold" id="oauth"><!--[-->OAuth<!--]--></h1><!--]--> <!--[--><h2 class="mt-6 -scroll-m-36 text-[27px] font-semibold tracking-[-0.01em] first:mt-0" id="overview"><!--[-->Overview<!--]--></h2><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->OAuth is a widely used protocol for authorization. It's what's behind "Sign in with Google" and "Sign in with GitHub." It allows users to grant access to their resources on an external service, like Google, to your application without sharing their credentials. Instead of implementing a password-based auth, we can replace it with OAuth to let a third-party service handle authentication. You can then get the user's profile and use that to create users and sessions.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->In a basic OAuth flow, the user is redirected to a third-party service, the service authenticates the user, and the user is redirected back to your application. An access token for the user is made available which allows you to request resources on behalf of the user.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->It requires 2 server endpoints in your application:<!--]--></p><!--]--> <!--[--><ol class="my-6 ml-6 list-decimal"><!--[--><!--[--><li class="mt-2"><!--[-->Login endpoint (GET): Redirects the user to the OAuth provider.<!--]--></li><!--]--> <!--[--><li class="mt-2"><!--[-->Callback endpoint (GET): Handles the redirect from the OAuth provider.<!--]--></li><!--]--><!--]--></ol><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->There are multiple versions of OAuth, with OAuth 2.0 being the latest one. This page will only cover OAuth 2.0, specifically the authorization code grant type, as standardized in <!--[--><a href="https://datatracker.ietf.org/doc/html/rfc6749" target="_blank" rel="noopener noreferrer" class="link text-blue-600 dark:text-blue-500"><!--[-->RFC 6749<!--]--></a><!--]-->. The implicit grant type is deprecated and should not be used.<!--]--></p><!--]--> <!--[--><h2 class="mt-6 -scroll-m-36 text-[27px] font-semibold tracking-[-0.01em] first:mt-0" id="create-authorization-url"><!--[-->Create authorization URL<!--]--></h2><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Using GitHub as an example, the first step is to create a GET endpoint (login endpoint) that redirects the user to GitHub. The redirect location is the authorization URL with a few parameters.<!--]--></p><!--]--> <figure data-rehype-pretty-code-figure=""><!--[--><pre class="relative mb-4 mt-6 overflow-x-auto rounded-card border-2 border-muted py-8 Serendipity Midnight Serendipity Morning" tabindex="0" data-language="untype" data-theme="Serendipity Midnight Serendipity Morning">
	<!--[--><!--[--><code data-language="untype" data-theme="Serendipity Midnight Serendipity Morning" style="display: grid;"><span data-line=""><span>https://github.com/login/oauth/authorize?</span></span>
<span data-line=""><span>response_type=code</span></span>
<span data-line=""><span>&amp;client_id=&lt;CLIENT_ID></span></span>
<span data-line=""><span>&amp;redirect_uri=&lt;CALLBACK_ENDPOINT></span></span>
<span data-line=""><span>&amp;state=&lt;STATE></span></span></code><!--]--><!--]-->
	<!--[--><button class="z-20 inline-flex h-9 w-9 items-center justify-center rounded-md text-sm font-medium text-muted-foreground transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background absolute right-4 top-4" aria-label="Copy" data-copy-code="true"><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-copy h-5 w-5"><!--[--><!--[--><!--[--><rect  width="14" height="14" x="8" y="8" rx="2" ry="2"><!--[--><!--]--></rect><!--]--><!--]--><!--[--><!--[--><path  d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--><!--]!--></button><!--]-->
</pre><!--]--></figure> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->The state is used to ensure the user initiating the process and the one we redirected back to (in the next section) are the same user. As such, a new state must be generated on each request. While it is not strictly required by the spec, it is highly recommended and may be required depending on the provider. It should be generated using a cryptographically secure random generator and have at least 112 bits of entropy. The state can also be used to pass data from the login endpoint to the callback endpoint, though a cookie can just be used instead.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Your server must keep track of the state associated with each attempt. One simple approach is to store it as a cookie with <!--[--><code>HttpOnly</code><!--]-->, <!--[--><code>SameSite=Lax</code><!--]-->, <!--[--><code>Secure</code><!--]-->, and <!--[--><code>Path=/</code><!--]--> attributes. You may also assign the state to the current session.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->You can define a <!--[--><code>scope</code><!--]--> parameter to request access to additional resources. If you have multiple scopes, they should be separated by spaces.<!--]--></p><!--]--> <figure data-rehype-pretty-code-figure=""><!--[--><pre class="relative mb-4 mt-6 overflow-x-auto rounded-card border-2 border-muted py-8 Serendipity Midnight Serendipity Morning" tabindex="0" data-language="untype" data-theme="Serendipity Midnight Serendipity Morning">
	<!--[--><!--[--><code data-language="untype" data-theme="Serendipity Midnight Serendipity Morning" style="display: grid;"><span data-line=""><span>&amp;scope=email%20identity</span></span></code><!--]--><!--]-->
	<!--[--><button class="z-20 inline-flex h-9 w-9 items-center justify-center rounded-md text-sm font-medium text-muted-foreground transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background absolute right-4 top-4" aria-label="Copy" data-copy-code="true"><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-copy h-5 w-5"><!--[--><!--[--><!--[--><rect  width="14" height="14" x="8" y="8" rx="2" ry="2"><!--[--><!--]--></rect><!--]--><!--]--><!--[--><!--[--><path  d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--><!--]!--></button><!--]-->
</pre><!--]--></figure> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->You can create a "Sign in" button by adding a link to the login endpoint.<!--]--></p><!--]--> <figure data-rehype-pretty-code-figure=""><!--[--><pre class="relative mb-4 mt-6 overflow-x-auto rounded-card border-2 border-muted py-8 Serendipity Midnight Serendipity Morning" tabindex="0" data-language="untype" data-theme="Serendipity Midnight Serendipity Morning">
	<!--[--><!--[--><code data-language="untype" data-theme="Serendipity Midnight Serendipity Morning" style="display: grid;"><span data-line=""><span>&lt;a href="/login/github">Sign in with GitHub&lt;/a></span></span></code><!--]--><!--]-->
	<!--[--><button class="z-20 inline-flex h-9 w-9 items-center justify-center rounded-md text-sm font-medium text-muted-foreground transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background absolute right-4 top-4" aria-label="Copy" data-copy-code="true"><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-copy h-5 w-5"><!--[--><!--[--><!--[--><rect  width="14" height="14" x="8" y="8" rx="2" ry="2"><!--[--><!--]--></rect><!--]--><!--]--><!--[--><!--[--><path  d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--><!--]!--></button><!--]-->
</pre><!--]--></figure> <!--[--><h2 class="mt-6 -scroll-m-36 text-[27px] font-semibold tracking-[-0.01em] first:mt-0" id="validate-authorization-code"><!--[-->Validate authorization code<!--]--></h2><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->The user will be redirected to the callback endpoint (as defined in <!--[--><code>redirect_uri</code><!--]-->) with a single-use authorization code, which is included as a query parameter. This code is then exchanged for an access token.<!--]--></p><!--]--> <figure data-rehype-pretty-code-figure=""><!--[--><pre class="relative mb-4 mt-6 overflow-x-auto rounded-card border-2 border-muted py-8 Serendipity Midnight Serendipity Morning" tabindex="0" data-language="untype" data-theme="Serendipity Midnight Serendipity Morning">
	<!--[--><!--[--><code data-language="untype" data-theme="Serendipity Midnight Serendipity Morning" style="display: grid;"><span data-line=""><span>https://example.com/login/github/callback?code=&lt;CODE>&amp;state=&lt;STATE></span></span></code><!--]--><!--]-->
	<!--[--><button class="z-20 inline-flex h-9 w-9 items-center justify-center rounded-md text-sm font-medium text-muted-foreground transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background absolute right-4 top-4" aria-label="Copy" data-copy-code="true"><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-copy h-5 w-5"><!--[--><!--[--><!--[--><rect  width="14" height="14" x="8" y="8" rx="2" ry="2"><!--[--><!--]--></rect><!--]--><!--]--><!--[--><!--[--><path  d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--><!--]!--></button><!--]-->
</pre><!--]--></figure> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->If you add a state to the authorization URL, the redirect request will include a <!--[--><code>state</code><!--]--> parameter. It is critical to check that it matches the state associated with the attempt. Return an error if the state is missing or if they don't match. A common mistake is forgetting to check whether the <!--[--><code>state</code><!--]--> parameter exists in the URL.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->The code is sent to the OAuth provider's token endpoint via an <!--[--><code>application/x-www-form-urlencoded</code><!--]--> POST request.<!--]--></p><!--]--> <figure data-rehype-pretty-code-figure=""><!--[--><pre class="relative mb-4 mt-6 overflow-x-auto rounded-card border-2 border-muted py-8 Serendipity Midnight Serendipity Morning" tabindex="0" data-language="untype" data-theme="Serendipity Midnight Serendipity Morning">
	<!--[--><!--[--><code data-language="untype" data-theme="Serendipity Midnight Serendipity Morning" style="display: grid;"><span data-line=""><span>POST https://github.com/login/oauth/access_token</span></span>
<span data-line=""><span>Accept: application/json</span></span>
<span data-line=""><span>Authorization: Basic &lt;CREDENTIALS></span></span>
<span data-line=""><span>Content-Type: application/x-www-form-urlencoded</span></span>
<span data-line=""> </span>
<span data-line=""><span>grant_type=authorization_code</span></span>
<span data-line=""><span>&amp;client_id=&lt;CLIENT_ID></span></span>
<span data-line=""><span>&amp;redirect_uri=&lt;CALLBACK_ENDPOINT></span></span>
<span data-line=""><span>&amp;code=&lt;CODE></span></span></code><!--]--><!--]-->
	<!--[--><button class="z-20 inline-flex h-9 w-9 items-center justify-center rounded-md text-sm font-medium text-muted-foreground transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background absolute right-4 top-4" aria-label="Copy" data-copy-code="true"><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-copy h-5 w-5"><!--[--><!--[--><!--[--><rect  width="14" height="14" x="8" y="8" rx="2" ry="2"><!--[--><!--]--></rect><!--]--><!--]--><!--[--><!--[--><path  d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--><!--]!--></button><!--]-->
</pre><!--]--></figure> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->If your OAuth provider uses a client secret, it should be base64 encoded with the client ID and secret included in the Authorization header (HTTP basic authorization scheme).<!--]--></p><!--]--> <figure data-rehype-pretty-code-figure=""><!--[--><pre class="relative mb-4 mt-6 overflow-x-auto rounded-card border-2 border-muted py-8 Serendipity Midnight Serendipity Morning" tabindex="0" data-language="untype" data-theme="Serendipity Midnight Serendipity Morning">
	<!--[--><!--[--><code data-language="untype" data-theme="Serendipity Midnight Serendipity Morning" style="display: grid;"><span data-line=""><span>var clientId, clientSecret string</span></span>
<span data-line=""><span>credentials := base64.StdEncoding.EncodeToString([]byte(clientId + ":" + clientSecret))</span></span></code><!--]--><!--]-->
	<!--[--><button class="z-20 inline-flex h-9 w-9 items-center justify-center rounded-md text-sm font-medium text-muted-foreground transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background absolute right-4 top-4" aria-label="Copy" data-copy-code="true"><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-copy h-5 w-5"><!--[--><!--[--><!--[--><rect  width="14" height="14" x="8" y="8" rx="2" ry="2"><!--[--><!--]--></rect><!--]--><!--]--><!--[--><!--[--><path  d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--><!--]!--></button><!--]-->
</pre><!--]--></figure> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Some providers also allow the client secret to be included in the body.<!--]--></p><!--]--> <figure data-rehype-pretty-code-figure=""><!--[--><pre class="relative mb-4 mt-6 overflow-x-auto rounded-card border-2 border-muted py-8 Serendipity Midnight Serendipity Morning" tabindex="0" data-language="untype" data-theme="Serendipity Midnight Serendipity Morning">
	<!--[--><!--[--><code data-language="untype" data-theme="Serendipity Midnight Serendipity Morning" style="display: grid;"><span data-line=""><span>POST https://github.com/login/oauth/access_token</span></span>
<span data-line=""><span>Accept: application/json</span></span>
<span data-line=""><span>Content-Type: application/x-www-form-urlencoded</span></span>
<span data-line=""> </span>
<span data-line=""><span>grant_type=authorization_code</span></span>
<span data-line=""><span>&amp;client_id=&lt;CLIENT_ID></span></span>
<span data-line=""><span>&amp;client_secret=&lt;CLIENT_SECRET></span></span>
<span data-line=""><span>&amp;redirect_uri=&lt;CALLBACK_ENDPOINT></span></span>
<span data-line=""><span>&amp;code=&lt;CODE></span></span></code><!--]--><!--]-->
	<!--[--><button class="z-20 inline-flex h-9 w-9 items-center justify-center rounded-md text-sm font-medium text-muted-foreground transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background absolute right-4 top-4" aria-label="Copy" data-copy-code="true"><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-copy h-5 w-5"><!--[--><!--[--><!--[--><rect  width="14" height="14" x="8" y="8" rx="2" ry="2"><!--[--><!--]--></rect><!--]--><!--]--><!--[--><!--[--><path  d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--><!--]!--></button><!--]-->
</pre><!--]--></figure> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->The request will return an access token, which can then be used to get the user's identity. It may also include other fields such as <!--[--><code>refresh_token</code><!--]--> and <!--[--><code>expires_in</code><!--]-->.<!--]--></p><!--]--> <figure data-rehype-pretty-code-figure=""><!--[--><pre class="relative mb-4 mt-6 overflow-x-auto rounded-card border-2 border-muted py-8 Serendipity Midnight Serendipity Morning" tabindex="0" data-language="untype" data-theme="Serendipity Midnight Serendipity Morning">
	<!--[--><!--[--><code data-language="untype" data-theme="Serendipity Midnight Serendipity Morning" style="display: grid;"><span data-line=""><span>&#123; "access_token": "&lt;ACCESS_TOKEN>" &#125;</span></span></code><!--]--><!--]-->
	<!--[--><button class="z-20 inline-flex h-9 w-9 items-center justify-center rounded-md text-sm font-medium text-muted-foreground transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background absolute right-4 top-4" aria-label="Copy" data-copy-code="true"><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-copy h-5 w-5"><!--[--><!--[--><!--[--><rect  width="14" height="14" x="8" y="8" rx="2" ry="2"><!--[--><!--]--></rect><!--]--><!--]--><!--[--><!--[--><path  d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--><!--]!--></button><!--]-->
</pre><!--]--></figure> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->For example, using the access token, you can get their GitHub profile and store their GitHub user ID, which will allow you to get their registered account when they sign in again. Be aware that the email address provided by the OAuth provider may not be verified. You may need to manually verify user emails or block users without a verified email.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->The access token itself should never be used as a replacement for sessions.<!--]--></p><!--]--> <!--[--><h2 class="mt-6 -scroll-m-36 text-[27px] font-semibold tracking-[-0.01em] first:mt-0" id="proof-key-for-code-exchange-pkce-flow"><!--[-->Proof key for code exchange (PKCE) flow<!--]--></h2><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->PKCE was introduced in <!--[--><a href="https://datatracker.ietf.org/doc/html/rfc7636" target="_blank" rel="noopener noreferrer" class="link text-blue-600 dark:text-blue-500"><!--[-->RFC 7636<!--]--></a><!--]--> to provide additional protection for OAuth 2.0. We recommend using it in addition to state and a client secret if your OAuth provider supports it. Be aware that some OAuth providers do not require a client secret when PKCE is enabled, in which case PKCE should not be used.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->PKCE can replace state entirely, as both protect against CSRF attacks, but it may be required by your OAuth provider.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->A new code verifier must be generated on each request. It should be generated using a cryptographically secure random generator and have at least 112 bits of entropy (256 bits recommended by the RFC). Similar to state, your application must keep track of the code verifier associated with each attempt (using cookies or sessions). A base64url (no padding) encoded SHA256 hash of it called a code challenge is included in the authorization URL.<!--]--></p><!--]--> <figure data-rehype-pretty-code-figure=""><!--[--><pre class="relative mb-4 mt-6 overflow-x-auto rounded-card border-2 border-muted py-8 Serendipity Midnight Serendipity Morning" tabindex="0" data-language="untype" data-theme="Serendipity Midnight Serendipity Morning">
	<!--[--><!--[--><code data-language="untype" data-theme="Serendipity Midnight Serendipity Morning" style="display: grid;"><span data-line=""><span>var codeVerifier string</span></span>
<span data-line=""><span>codeChallengeBuf := sha256.Sum256([]byte(codeVerifier))</span></span>
<span data-line=""><span>codeChallenge := base64.URLEncoding.WithPadding(base64.NoPadding).EncodeToString(codeChallengeBuf)</span></span></code><!--]--><!--]-->
	<!--[--><button class="z-20 inline-flex h-9 w-9 items-center justify-center rounded-md text-sm font-medium text-muted-foreground transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background absolute right-4 top-4" aria-label="Copy" data-copy-code="true"><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-copy h-5 w-5"><!--[--><!--[--><!--[--><rect  width="14" height="14" x="8" y="8" rx="2" ry="2"><!--[--><!--]--></rect><!--]--><!--]--><!--[--><!--[--><path  d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--><!--]!--></button><!--]-->
</pre><!--]--></figure> <figure data-rehype-pretty-code-figure=""><!--[--><pre class="relative mb-4 mt-6 overflow-x-auto rounded-card border-2 border-muted py-8 Serendipity Midnight Serendipity Morning" tabindex="0" data-language="untype" data-theme="Serendipity Midnight Serendipity Morning">
	<!--[--><!--[--><code data-language="untype" data-theme="Serendipity Midnight Serendipity Morning" style="display: grid;"><span data-line=""><span>https://accounts.google.com/o/oauth2/v2/auth?</span></span>
<span data-line=""><span>response_type=code</span></span>
<span data-line=""><span>&amp;client_id=&lt;...></span></span>
<span data-line=""><span>&amp;redirect_uri=&lt;...></span></span>
<span data-line=""><span>&amp;state=&lt;...></span></span>
<span data-line=""><span>&amp;code_challenge_method=S256</span></span>
<span data-line=""><span>&amp;code_challenge=&lt;CODE_CHALLENGE></span></span></code><!--]--><!--]-->
	<!--[--><button class="z-20 inline-flex h-9 w-9 items-center justify-center rounded-md text-sm font-medium text-muted-foreground transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background absolute right-4 top-4" aria-label="Copy" data-copy-code="true"><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-copy h-5 w-5"><!--[--><!--[--><!--[--><rect  width="14" height="14" x="8" y="8" rx="2" ry="2"><!--[--><!--]--></rect><!--]--><!--]--><!--[--><!--[--><path  d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--><!--]!--></button><!--]-->
</pre><!--]--></figure> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->In the callback endpoint, the code verifier of the current attempt should be sent alongside the authorization code.<!--]--></p><!--]--> <figure data-rehype-pretty-code-figure=""><!--[--><pre class="relative mb-4 mt-6 overflow-x-auto rounded-card border-2 border-muted py-8 Serendipity Midnight Serendipity Morning" tabindex="0" data-language="untype" data-theme="Serendipity Midnight Serendipity Morning">
	<!--[--><!--[--><code data-language="untype" data-theme="Serendipity Midnight Serendipity Morning" style="display: grid;"><span data-line=""><span>POST https://oauth2.googleapis.com/token</span></span>
<span data-line=""><span>Accept: application/json</span></span>
<span data-line=""><span>Authorization: Basic &lt;CREDENTIALS></span></span>
<span data-line=""><span>Content-Type: application/x-www-form-urlencoded</span></span>
<span data-line=""> </span>
<span data-line=""><span>grant_type=authorization_code</span></span>
<span data-line=""><span>&amp;client_id=&lt;...></span></span>
<span data-line=""><span>&amp;redirect_uri=&lt;...></span></span>
<span data-line=""><span>&amp;code=&lt;...></span></span>
<span data-line=""><span>&amp;code_verifier=&lt;CODE_VERIFIER></span></span></code><!--]--><!--]-->
	<!--[--><button class="z-20 inline-flex h-9 w-9 items-center justify-center rounded-md text-sm font-medium text-muted-foreground transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background absolute right-4 top-4" aria-label="Copy" data-copy-code="true"><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-copy h-5 w-5"><!--[--><!--[--><!--[--><rect  width="14" height="14" x="8" y="8" rx="2" ry="2"><!--[--><!--]--></rect><!--]--><!--]--><!--[--><!--[--><path  d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--><!--]!--></button><!--]-->
</pre><!--]--></figure> <!--[--><h2 class="mt-6 -scroll-m-36 text-[27px] font-semibold tracking-[-0.01em] first:mt-0" id="openid-connect-oidc"><!--[-->OpenID Connect (OIDC)<!--]--></h2><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[--><!--[--><a href="https://openid.net/specs/openid-connect-core-1_0.html" target="_blank" rel="noopener noreferrer" class="link text-blue-600 dark:text-blue-500"><!--[-->OpenID Connect<!--]--></a><!--]--> is a widely used protocol built on top of OAuth 2.0. An important addition to OAuth is that the identity provider returns an ID token alongside the access token. An ID token is a <!--[--><a href="https://datatracker.ietf.org/doc/html/rfc7519" target="_blank" rel="noopener noreferrer" class="link text-blue-600 dark:text-blue-500"><!--[-->JSON Web Token<!--]--></a><!--]--> that includes user data. It will always include a unique identifier for the user in the <!--[--><code>sub</code><!--]--> field.<!--]--></p><!--]--> <figure data-rehype-pretty-code-figure=""><!--[--><pre class="relative mb-4 mt-6 overflow-x-auto rounded-card border-2 border-muted py-8 Serendipity Midnight Serendipity Morning" tabindex="0" data-language="untype" data-theme="Serendipity Midnight Serendipity Morning">
	<!--[--><!--[--><code data-language="untype" data-theme="Serendipity Midnight Serendipity Morning" style="display: grid;"><span data-line=""><span>&#123;</span></span>
<span data-line=""><span>	"access_token": "&lt;ACCESS_TOKEN>",</span></span>
<span data-line=""><span>	"id_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwiaXNzIjoiZXhhbXBsZS5jb20ifQ.uMMQPfp7LwcLiBbfZdoHdIPjKgS2HUfOr5vlY71el8A"</span></span>
<span data-line=""><span>&#125;</span></span></code><!--]--><!--]-->
	<!--[--><button class="z-20 inline-flex h-9 w-9 items-center justify-center rounded-md text-sm font-medium text-muted-foreground transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background absolute right-4 top-4" aria-label="Copy" data-copy-code="true"><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-copy h-5 w-5"><!--[--><!--[--><!--[--><rect  width="14" height="14" x="8" y="8" rx="2" ry="2"><!--[--><!--]--></rect><!--]--><!--]--><!--[--><!--[--><path  d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--><!--]!--></button><!--]-->
</pre><!--]--></figure> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->While you can validate the token with a public key, this is not strictly necessary for server-side applications if you're using HTTPS for communications.<!--]--></p><!--]--> <!--[--><h3 class="mt-6 scroll-m-20 text-xl font-semibold tracking-tight" id="openid-connect-discovery"><!--[-->OpenID Connect Discovery<!--]--></h3><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->OpenID Connect defines a <!--[--><a href="https://openid.net/specs/openid-connect-discovery-1_0.html" target="_blank" rel="noopener noreferrer" class="link text-blue-600 dark:text-blue-500"><!--[-->discovery mechanism<!--]--></a><!--]--> that allows clients to dynamically fetch the OpenID Provider's configuration, including the OAuth 2.0 endpoint locations. This eliminates the need to hard-code endpoint URLs in your application. To use OpenID Connect Discovery, your OpenID Provider must have a discovery endpoint available.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->The discovery endpoint is a well-known URL that returns a JSON document containing the OpenID Provider's configuration information. Note that not all OAuth providers support OpenID Connect Discovery. Check your provider's documentation to determine if they offer a discovery endpoint. If not, you may still need to manually configure the endpoint URLs in your application.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->The well-known URL has the path <!--[--><code>/.well-known/openid-configuration</code><!--]-->. For example, Google's Discovery Endpoint looks like this:<!--]--></p><!--]--> <figure data-rehype-pretty-code-figure=""><!--[--><pre class="relative mb-4 mt-6 overflow-x-auto rounded-card border-2 border-muted py-8 Serendipity Midnight Serendipity Morning" tabindex="0" data-language="untype" data-theme="Serendipity Midnight Serendipity Morning">
	<!--[--><!--[--><code data-language="untype" data-theme="Serendipity Midnight Serendipity Morning" style="display: grid;"><span data-line=""><span>https://accounts.google.com/.well-known/openid-configuration</span></span></code><!--]--><!--]-->
	<!--[--><button class="z-20 inline-flex h-9 w-9 items-center justify-center rounded-md text-sm font-medium text-muted-foreground transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background absolute right-4 top-4" aria-label="Copy" data-copy-code="true"><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-copy h-5 w-5"><!--[--><!--[--><!--[--><rect  width="14" height="14" x="8" y="8" rx="2" ry="2"><!--[--><!--]--></rect><!--]--><!--]--><!--[--><!--[--><path  d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--><!--]!--></button><!--]-->
</pre><!--]--></figure> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->The endpoint will return a JSON object containing the OpenID Provider's configuration, including the endpoint URLs for authorization, token exchange, and user info retrieval.<!--]--></p><!--]--> <figure data-rehype-pretty-code-figure=""><!--[--><pre class="relative mb-4 mt-6 overflow-x-auto rounded-card border-2 border-muted py-8 Serendipity Midnight Serendipity Morning" tabindex="0" data-language="untype" data-theme="Serendipity Midnight Serendipity Morning">
	<!--[--><!--[--><code data-language="untype" data-theme="Serendipity Midnight Serendipity Morning" style="display: grid;"><span data-line=""><span>&#123;</span></span>
<span data-line=""><span>	"issuer": "https://example.com",</span></span>
<span data-line=""><span>	"authorization_endpoint": "https://example.com/oauth2/authorize",</span></span>
<span data-line=""><span>	"token_endpoint": "https://example.com/oauth2/token",</span></span>
<span data-line=""><span>	"userinfo_endpoint": "https://example.com/oauth2/userinfo",</span></span>
<span data-line=""><span>	"code_challenge_methods_supported": ["S256"],</span></span>
<span data-line=""><span>	"grant_types_supported": ["authorization_code", "refresh_token"],</span></span>
<span data-line=""><span>	"scopes_supported": ["openid", "email", "profile"]</span></span>
<span data-line=""><span>&#125;</span></span></code><!--]--><!--]-->
	<!--[--><button class="z-20 inline-flex h-9 w-9 items-center justify-center rounded-md text-sm font-medium text-muted-foreground transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background absolute right-4 top-4" aria-label="Copy" data-copy-code="true"><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-copy h-5 w-5"><!--[--><!--[--><!--[--><rect  width="14" height="14" x="8" y="8" rx="2" ry="2"><!--[--><!--]--></rect><!--]--><!--]--><!--[--><!--[--><path  d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--><!--]!--></button><!--]-->
</pre><!--]--></figure> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->With OpenID Connect Discovery, your application can dynamically adapt to changes in the OpenID Provider's configuration without requiring code updates. This ensures that your application always uses the most up-to-date endpoint URLs. The drawback is that you will have to make extra fetch requests.<!--]--></p><!--]--> <!--[--><h2 class="mt-6 -scroll-m-36 text-[27px] font-semibold tracking-[-0.01em] first:mt-0" id="account-linking"><!--[-->Account linking<!--]--></h2><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Account linking allows users to sign in with any of their social accounts and be authenticated as the same user on your application. It is usually done by checking the email address registered with the provider. If you're using email to link accounts, make sure to validate the user's email. Most providers provide a <!--[--><code>is_verified</code><!--]--> field or similar in user profiles. Do not assume that the email has been verified unless the provider explicitly mentions it in their documentation. Users without a verified email should be prevented from completing the authentication process and prompted to verify their email first.<!--]--></p><!--]--> <!--[--><h2 class="mt-6 -scroll-m-36 text-[27px] font-semibold tracking-[-0.01em] first:mt-0" id="other-considerations"><!--[-->Other considerations<!--]--></h2><!--]--> <!--[--><ul class="ml-6 list-disc"><!--[--><!--[--><li class="mt-2"><!--[--><!--[--><a href="/content/open-redirect" class="link text-blue-600 dark:text-blue-500"><!--[-->Open redirect<!--]--></a><!--]--><!--]--></li><!--]--><!--]--></ul><!--]--><!--]--><!--]--><!--]--><!--]--><!--]--></div> <!--[--><div class="hidden text-sm xl:block"><div class="sticky top-16 -mt-10 h-[calc(100vh-3.5rem)] overflow-hidden pt-6"><!--[--><div class="mt-1 overflow-y-auto rounded-lg p-4"><nav><!--[--><!--[--><ul class="m-0 list-none"><!--[--><!--]!--></ul><!--]--><!--]--></nav></div><!--]--></div></div><!--]--></main></div></div><!--]--><!--]--> <!--[--><!--]!--><!--]-->
			
			<script>
				{
					__sveltekit_rpkwke = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					const data = [null,null];

					Promise.all([
						import("../_app/immutable/entry/start.Ckx-DEvp.js"),
						import("../_app/immutable/entry/app.HqDmpUJI.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 3],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
<!--- /\_/\ --->
<!---( o.o )--->
<!--- > ^ < --->
