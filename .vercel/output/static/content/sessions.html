<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="../_app/immutable/assets/0.ULhG9gpl.css" rel="stylesheet">
		<link href="../_app/immutable/assets/Toaster.Dljj2rV8.css" rel="stylesheet">
		<link href="../_app/immutable/assets/3.BJlDkOpa.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.Ckx-DEvp.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/entry.Ie7rGrFD.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/runtime.BAFUM52B.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/control.CYgJF_JY.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.HqDmpUJI.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/preload-helper.D6kgxu3v.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/disclose-version.Bedei8AD.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index-client.KQq4m8LZ.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/svelte-component.DMSORSFP.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.ChhUFNes.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Toaster.svelte_svelte_type_style_lang.BmHREJqO.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/store.9yGI1nh7.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/attributes.D0NGgthW.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index.DWgPtC_I.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/stores.B8GNZjuf.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/3.DJF7piDy.js"><!--[--><!--[--><!--]!--> <!--[--><script nonce="%sveltekit.nonce%">(function setInitialMode(defaultMode, themeColors2) {
  const rootEl = document.documentElement;
  const mode = localStorage.getItem("mode-watcher-mode") || defaultMode;
  const light = mode === "light" || mode === "system" && window.matchMedia("(prefers-color-scheme: light)").matches;
  rootEl.classList[light ? "remove" : "add"]("dark");
  rootEl.style.colorScheme = light ? "light" : "dark";
  if (themeColors2) {
    const themeMetaEl = document.querySelector('meta[name="theme-color"]');
    if (themeMetaEl) {
      themeMetaEl.setAttribute("content", mode === "light" ? themeColors2.light : themeColors2.dark);
    }
  }
  localStorage.setItem("mode-watcher-mode", mode);
})("system");</script><!--]--><!--]--><!--[--><meta property="og:type" content="article"> <meta property="og:title" content="Sessions"><!--]--><title>Sessions</title>
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents"><!--[--><!--[--><!--[--><!--[--><!--]--> <!--[--><!--[--><!--]!--><!--]--> <!--[--><header class="sticky top-0 z-50 overflow-x-hidden border-b border-border bg-background/75 backdrop-blur-md"><div class="container px-4"><div class="flex h-[70px] items-center justify-between gap-3"><div class="flex items-center gap-1.5"><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><button  type="button" tabindex="0" aria-haspopup="dialog" aria-expanded="false" data-melt-dialog-trigger="" data-dialog-trigger="" class="inline-flex items-center justify-center whitespace-nowrap rounded-md font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:text-accent-foreground h-10 py-2 mr-2 px-0 text-base hover:bg-transparent focus-visible:bg-transparent focus-visible:ring-0 focus-visible:ring-offset-0 md:hidden" data-button-root=""><!--[--><!--[--><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-menu h-5 w-5"><!--[--><!--[--><!--[--><line  x1="4" x2="20" y1="12" y2="12"><!--[--><!--]--></line><!--]--><!--]--><!--[--><!--[--><line  x1="4" x2="20" y1="6" y2="6"><!--[--><!--]--></line><!--]--><!--]--><!--[--><!--[--><line  x1="4" x2="20" y1="18" y2="18"><!--[--><!--]--></line><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--> <span class="sr-only">Toggle Menu</span><!--]--><!--]--><!--]--></button><!--]--><!--]--><!--]--><!--]--><!--]--><!--]--><!--]--> <!--[--><!--[--><!--[--><!--[--><div data-portal="" data-melt-dialog-portalled="" data-dialog-portal=""><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--]!--><!--]!--><!--]!--><!--]!--><!--]!--><!--]!--><!--]--><!--]--> <!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--]!--><!--]!--><!--]!--><!--]!--><!--]!--><!--]!--><!--]--><!--]--><!--]--></div><!--]!--><!--]--><!--]--><!--]--><!--]--><!--]--><!--]--> <a href="/" class="ml-2 rounded-md font-quicksand focus-visible:outline-none text-xl font-bold focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background">The Copenhagen Book</a></div> <div class="flex items-center justify-end gap-2.5"><!--[--><!--[--><!--[--><!--[--><button  type="button" tabindex="0" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-10 w-10" data-button-root=""><!--[--><!--[--><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-sun h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"><!--[--><!--[--><!--[--><circle  cx="12" cy="12" r="4"><!--[--><!--]--></circle><!--]--><!--]--><!--[--><!--[--><path  d="M12 2v2"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="M12 20v2"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="m4.93 4.93 1.41 1.41"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="m17.66 17.66 1.41 1.41"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="M2 12h2"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="M20 12h2"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="m6.34 17.66-1.41 1.41"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="m19.07 4.93-1.41 1.41"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--> <!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-moon absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"><!--[--><!--[--><!--[--><path  d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--> <span class="sr-only">Change theme</span><!--]--><!--]--><!--]--></button><!--]--><!--]!--><!--]--><!--]--></div></div></div></header><!--]--> <div class="min-h-[calc(100vh-64px)]"><div class="container flex-1 items-start md:grid md:grid-cols-[220px_minmax(0,1fr)] md:gap-6 lg:grid-cols-[250px_minmax(0,1fr)] lg:gap-10"><!--[--><!--[--><aside class="fixed top-10 z-30 hidden h-[calc(100vh-3.5rem)] w-full shrink-0 overflow-y-auto border-r border-border md:sticky md:block"><div class="h-full py-6 pr-4 lg:py-8"><nav class="space-y-3"><div class="flex w-full flex-col pb-[50px]"><!--[--><!--[--><!--[--><!--[--><!--[--><div class="grid grid-flow-row auto-rows-max gap-0.5 pb-2 pl-4 text-sm"><!--[--><!--[--><!--[--><a href="/content/index" class="group flex w-full items-center gap-2.5 rounded-md px-2.5 py-1.5 text-sm font-semibold text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Introduction <!--[--><!--]!--></a><!--]--><!--]--><!--]--></div><!--]--><!--]--><!--]--><!--]--><!--[--><!--[--><div class="pb-4"><h4 class="mb-1 ml-[9px] rounded-md px-2.5 py-2 pl-4 text-xs font-medium uppercase text-muted-foreground">content</h4> <!--[--><!--[--><!--[--><div class="grid grid-flow-row auto-rows-max gap-0.5 pl-4 text-sm"><!--[--><!--[--><!--[--><a href="/content/server-side-tokens" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Server-side tokens <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/sessions" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background text-blue-600 dark:text-blue-500" target="" rel="">Sessions <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/password-authentication" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Password authentication <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/email-verification" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Email verification <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/password-reset" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Password reset <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/random-values" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Generating random values <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/oauth" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">OAuth <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/mfa" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Multi-factor authentication (MFA) <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/passkeys" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Passkeys <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/csrf" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Cross-site request forgery (CSRF) <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/open-redirect" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Open redirect <!--[--><!--]!--></a><!--]--><!--]--><!--]--></div><!--]--><!--]--><!--]--></div><!--]!--><!--]--><!--]--></div></nav></div></aside><!--]--><!--]--> <main class="relative pb-6 pl-4 pr-4 pt-16 md:pl-0 lg:gap-10 xl:grid-cols-[1fr_220px] xl:grid"><div class="mx-auto w-full min-w-0 md:max-w-[700px]" id="content"><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><h1 class="mt-2 scroll-m-20 text-4xl font-bold" id="sessions"><!--[-->Sessions<!--]--></h1><!--]--> <!--[--><h2 class="mt-6 -scroll-m-36 text-[27px] font-semibold tracking-[-0.01em] first:mt-0" id="overview"><!--[-->Overview<!--]--></h2><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Throughout a user's visit to your website, they will make multiple requests to your server. If you need to persist state, such as user preference, across those requests, HTTP doesn't provide a mechanism for it. It's a stateless protocol.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Sessions are a way to persist state in the server. It is especially useful for managing the authentication state, such as the client's identity. We can assign each session with a unique ID and store it on the server to use it as a token. Then the client can associate the request with a session by sending the session ID with it. To implement authentication, we can simply store user data alongside the session.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->It's important that the session ID is sufficiently long and random, or else someone could impersonate other users by just guessing their session IDs. See the <!--[--><a href="/content/server-side-tokens" class="link text-blue-600 dark:text-blue-500"><!--[-->Server-side tokens<!--]--></a><!--]--> guide for generating secure session IDs. Session IDs can be hashed before storage to provide an extra level of security.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Depending on your application, you may only have to manage sessions for authenticated users, or for both authenticated and unauthenticated users. You can even manage 2 different kinds of sessions - one for auth and another for non-auth related state.<!--]--></p><!--]--> <!--[--><h2 class="mt-6 -scroll-m-36 text-[27px] font-semibold tracking-[-0.01em] first:mt-0" id="session-lifetime"><!--[-->Session lifetime<!--]--></h2><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->If you only manage sessions for authenticated users, a new session is created whenever a user signs in. If you plan to manage session for non-authenticated users as well, sessions should be automatically created when an incoming request doesn't include a valid session. Make sure you don't make your application vulnerable to <!--[--><a href="#session-fixation-attacks" class="link text-blue-600 dark:text-blue-500"><!--[-->session fixation attacks<!--]--></a><!--]-->.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->For security-critical applications, it is crucial for sessions to expire automatically. This minimizes the time an attacker has to hijack sessions. The expiration should match how long the user is expected to use your application in a single sitting.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->However, for less critical websites, such as a social media app, it would be annoying for users if they had to sign in every single day. A good practice here is to set the expiration to a reasonable time, like 30 days, but extend the expiration whenever the session is used. For example, sessions may expire in 30 days by default, but the expiration gets pushed back 30 days when it's used within 15 days before expiration. This effectively invalidates sessions for inactive users, while keeping active users signed in.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->You can also combine both approaches. For example, you can set the expiration to an hour and extend it every 30 minutes but set an absolute expiration of 12 hours so sessions won't last for longer than that.<!--]--></p><!--]--> <figure data-rehype-pretty-code-figure=""><!--[--><pre class="relative mb-4 mt-6 overflow-x-auto rounded-card border-2 border-muted py-8 Serendipity Midnight Serendipity Morning" tabindex="0" data-language="untype" data-theme="Serendipity Midnight Serendipity Morning">
	<!--[--><!--[--><code data-language="untype" data-theme="Serendipity Midnight Serendipity Morning" style="display: grid;"><span data-line=""><span>const sessionExpiresIn = 30 * 24 * time.Hour</span></span>
<span data-line=""> </span>
<span data-line=""><span>func validateSession(sessionId string) (*Session, error) &#123;</span></span>
<span data-line=""><span>	session, ok := getSessionFromStorage(sessionId)</span></span>
<span data-line=""><span>	if !ok &#123;</span></span>
<span data-line=""><span>		return nil, errors.New("invalid session id")</span></span>
<span data-line=""><span>	&#125;</span></span>
<span data-line=""><span>	if time.Now().After(session.ExpiresAt) &#123;</span></span>
<span data-line=""><span>		return nil, errors.New("expired session")</span></span>
<span data-line=""><span>	&#125;</span></span>
<span data-line=""><span>	if time.Now().After(session.expiresAt.Sub(sessionExpiresIn / 2)) &#123;</span></span>
<span data-line=""><span>		session.ExpiresAt = time.Now().Add(sessionExpiresIn)</span></span>
<span data-line=""><span>		updateSessionExpiration(session.Id, session.ExpiresAt)</span></span>
<span data-line=""><span>	&#125;</span></span>
<span data-line=""><span>	return session, nil</span></span>
<span data-line=""><span>&#125;</span></span></code><!--]--><!--]-->
	<!--[--><button class="z-20 inline-flex h-9 w-9 items-center justify-center rounded-md text-sm font-medium text-muted-foreground transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background absolute right-4 top-4" aria-label="Copy" data-copy-code="true"><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-copy h-5 w-5"><!--[--><!--[--><!--[--><rect  width="14" height="14" x="8" y="8" rx="2" ry="2"><!--[--><!--]--></rect><!--]--><!--]--><!--[--><!--[--><path  d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--><!--]!--></button><!--]-->
</pre><!--]--></figure> <!--[--><h3 class="mt-6 scroll-m-20 text-xl font-semibold tracking-tight" id="sudo-mode"><!--[-->Sudo mode<!--]--></h3><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->An alternative to short-lived sessions is to implement long-lived sessions coupled with sudo mode. Sudo mode allows authenticated users to access security-critical components for a limited time by re-authenticating with one of their credentials (passwords, passkeys, TOTP, etc). A simple way to implement this is by keeping track of when the user last used their credentials in each session. This approach provides the security benefits of short-lived sessions without annoying frequent users. This can also help against <!--[--><a href="#session-hijacking" class="link text-blue-600 dark:text-blue-500"><!--[-->session hijacking<!--]--></a><!--]-->.<!--]--></p><!--]--> <!--[--><h2 class="mt-6 -scroll-m-36 text-[27px] font-semibold tracking-[-0.01em] first:mt-0" id="session-hijacking"><!--[-->Session hijacking<!--]--></h2><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Session hijacking is another word for stealing sessions. Common attacks include XSS, man-in-the-middle (MITM), and session sniffing. MITM attacks are especially hard to mitigate since it's ultimately up to the users to protect their device and network. Still, there are some ways to protect your users.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->First, consider tracking the user agent (device) and IP address linked to the session to detect suspicious requests. IP addresses can be dynamic for mobile users so you may want to keep track of the general area (country) instead of the specific address. Limiting the number of sessions connected to a user based on these information is also a good safeguard.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Since IP addresses and request headers can be easily spoofed, however, implementing <!--[--><a href="#sudo-mode" class="link text-blue-600 dark:text-blue-500"><!--[-->sudo mode<!--]--></a><!--]--> is recommended for any security-critical applications.<!--]--></p><!--]--> <!--[--><h2 class="mt-6 -scroll-m-36 text-[27px] font-semibold tracking-[-0.01em] first:mt-0" id="session-invalidation"><!--[-->Session invalidation<!--]--></h2><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Sessions can be invalidated by deleting it from both server and client storage.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->When the user signs out, invalidate the current session, or for security-critical applications, invalidate all sessions belonging to that user.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->All sessions of the user should also be invalidated when they gain new permissions (email verification, new role, etc) or change passwords.<!--]--></p><!--]--> <!--[--><h2 class="mt-6 -scroll-m-36 text-[27px] font-semibold tracking-[-0.01em] first:mt-0" id="client-storage"><!--[-->Client storage<!--]--></h2><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->The client should store the session ID in the user's device to be used for subsequent requests. The browser mainly provides 2 ways to store data - cookies and the Web Storage API. Cookies should be preferred for websites as they're automatically included in requests by the browser.<!--]--></p><!--]--> <!--[--><h3 class="mt-6 scroll-m-20 text-xl font-semibold tracking-tight" id="cookies"><!--[-->Cookies<!--]--></h3><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Session cookies should have the following attributes:<!--]--></p><!--]--> <!--[--><ul class="ml-6 list-disc"><!--[--><!--[--><li class="mt-2"><!--[--><!--[--><code>HttpOnly</code><!--]-->: Cookies are only accessible server-side<!--]--></li><!--]--> <!--[--><li class="mt-2"><!--[--><!--[--><code>SameSite=Lax</code><!--]-->: Use <!--[--><code>Strict</code><!--]--> for critical websites<!--]--></li><!--]--> <!--[--><li class="mt-2"><!--[--><!--[--><code>Secure</code><!--]-->: Cookies can only be sent over HTTPS<!--]--></li><!--]--> <!--[--><li class="mt-2"><!--[--><!--[--><code>Max-Age</code><!--]--> or <!--[--><code>Expires</code><!--]-->: Must be defined to persist cookies<!--]--></li><!--]--> <!--[--><li class="mt-2"><!--[--><!--[--><code>Path=/</code><!--]-->: Cookies can be accessed from all routes<!--]--></li><!--]--><!--]--></ul><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[--><!--[--><a href="/content/csrf" class="link text-blue-600 dark:text-blue-500"><!--[-->CSRF protection<!--]--></a><!--]--> must be implemented when using cookies, and using the <!--[--><code>SameSite</code><!--]--> flag is not sufficient. Using cookies does not automatically protect your users from cross-site scripting attacks (XSS) as well. While the session ID can't be read directly, authenticated requests can still be made as browsers automatically include cookies in requests.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->The maximum expiration for a cookie is anywhere between 1 and 2 years. If you plan for the session to be long-lived, continuously set the cookie on a set interval (e.g. when you extend the session expiration).<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[--><!--[--><code>Lax</code><!--]--> should be preferred over <!--[--><code>Strict</code><!--]--> for the <!--[--><code>SameSite</code><!--]--> attribute as using <!--[--><code>Strict</code><!--]--> will cause the browser to not send the session cookie when the user visits your application via an external link.<!--]--></p><!--]--> <!--[--><h3 class="mt-6 scroll-m-20 text-xl font-semibold tracking-tight" id="web-storage-api"><!--[-->Web Storage API<!--]--></h3><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Another option is to store session IDs inside <!--[--><code>localStorage</code><!--]--> or <!--[--><code>sessionStorage</code><!--]-->. If your website has an XSS vulnerability, this will allow attackers to directly read and steal the user's session ID. It is especially vulnerable to supply chain attacks since tokens can be stolen by just reading the entire local storage, without using any application-specific exploits.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Session tokens can be sent with the request using the <!--[--><code>Authorization</code><!--]--> header for example. Do not send them inside URLs as query parameters or inside form data, nor should tokens sent in this manner be accepted.<!--]--></p><!--]--> <!--[--><h2 class="mt-6 -scroll-m-36 text-[27px] font-semibold tracking-[-0.01em] first:mt-0" id="session-fixation-attacks"><!--[-->Session fixation attacks<!--]--></h2><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Applications that maintain sessions for both authenticated and unauthenticated users and reuse the current session when a user signs in are vulnerable to session fixation attacks.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Say an application allows the session ID to be sent inside the URL as a query parameter. If an attacker shares a link to the sign-in page with a session ID already included and the user signs in, the attacker now has a valid session ID to impersonate that user. A similar attack can be done if the application accepts session IDs in forms or cookies, though the latter requires an XSS vulnerability to exploit.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->This can be avoided by always creating a new session when the user signs in and only accepting session IDs via cookies and request headers.<!--]--></p><!--]--><!--]--><!--]--><!--]--><!--]--><!--]--></div> <!--[--><div class="hidden text-sm xl:block"><div class="sticky top-16 -mt-10 h-[calc(100vh-3.5rem)] overflow-hidden pt-6"><!--[--><div class="mt-1 overflow-y-auto rounded-lg p-4"><nav><!--[--><!--[--><ul class="m-0 list-none"><!--[--><!--]!--></ul><!--]--><!--]--></nav></div><!--]--></div></div><!--]--></main></div></div><!--]--><!--]--> <!--[--><!--]!--><!--]-->
			
			<script>
				{
					__sveltekit_rpkwke = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					const data = [null,null];

					Promise.all([
						import("../_app/immutable/entry/start.Ckx-DEvp.js"),
						import("../_app/immutable/entry/app.HqDmpUJI.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 3],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
<!--- /\_/\ --->
<!---( o.o )--->
<!--- > ^ < --->
