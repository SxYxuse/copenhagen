<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="../_app/immutable/assets/0.ULhG9gpl.css" rel="stylesheet">
		<link href="../_app/immutable/assets/Toaster.Dljj2rV8.css" rel="stylesheet">
		<link href="../_app/immutable/assets/3.BJlDkOpa.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.Ckx-DEvp.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/entry.Ie7rGrFD.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/runtime.BAFUM52B.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/control.CYgJF_JY.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.HqDmpUJI.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/preload-helper.D6kgxu3v.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/disclose-version.Bedei8AD.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index-client.KQq4m8LZ.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/svelte-component.DMSORSFP.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.ChhUFNes.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Toaster.svelte_svelte_type_style_lang.BmHREJqO.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/store.9yGI1nh7.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/attributes.D0NGgthW.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index.DWgPtC_I.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/stores.B8GNZjuf.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/3.DJF7piDy.js"><!--[--><!--[--><!--]!--> <!--[--><script nonce="%sveltekit.nonce%">(function setInitialMode(defaultMode, themeColors2) {
  const rootEl = document.documentElement;
  const mode = localStorage.getItem("mode-watcher-mode") || defaultMode;
  const light = mode === "light" || mode === "system" && window.matchMedia("(prefers-color-scheme: light)").matches;
  rootEl.classList[light ? "remove" : "add"]("dark");
  rootEl.style.colorScheme = light ? "light" : "dark";
  if (themeColors2) {
    const themeMetaEl = document.querySelector('meta[name="theme-color"]');
    if (themeMetaEl) {
      themeMetaEl.setAttribute("content", mode === "light" ? themeColors2.light : themeColors2.dark);
    }
  }
  localStorage.setItem("mode-watcher-mode", mode);
})("system");</script><!--]--><!--]--><!--[--><meta property="og:type" content="article"> <meta property="og:title" content="Password authentication"><!--]--><title>Password authentication</title>
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents"><!--[--><!--[--><!--[--><!--[--><!--]--> <!--[--><!--[--><!--]!--><!--]--> <!--[--><header class="sticky top-0 z-50 overflow-x-hidden border-b border-border bg-background/75 backdrop-blur-md"><div class="container px-4"><div class="flex h-[70px] items-center justify-between gap-3"><div class="flex items-center gap-1.5"><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><button  type="button" tabindex="0" aria-haspopup="dialog" aria-expanded="false" data-melt-dialog-trigger="" data-dialog-trigger="" class="inline-flex items-center justify-center whitespace-nowrap rounded-md font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:text-accent-foreground h-10 py-2 mr-2 px-0 text-base hover:bg-transparent focus-visible:bg-transparent focus-visible:ring-0 focus-visible:ring-offset-0 md:hidden" data-button-root=""><!--[--><!--[--><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-menu h-5 w-5"><!--[--><!--[--><!--[--><line  x1="4" x2="20" y1="12" y2="12"><!--[--><!--]--></line><!--]--><!--]--><!--[--><!--[--><line  x1="4" x2="20" y1="6" y2="6"><!--[--><!--]--></line><!--]--><!--]--><!--[--><!--[--><line  x1="4" x2="20" y1="18" y2="18"><!--[--><!--]--></line><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--> <span class="sr-only">Toggle Menu</span><!--]--><!--]--><!--]--></button><!--]--><!--]--><!--]--><!--]--><!--]--><!--]--><!--]--> <!--[--><!--[--><!--[--><!--[--><div data-portal="" data-melt-dialog-portalled="" data-dialog-portal=""><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--]!--><!--]!--><!--]!--><!--]!--><!--]!--><!--]!--><!--]--><!--]--> <!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><!--]!--><!--]!--><!--]!--><!--]!--><!--]!--><!--]!--><!--]--><!--]--><!--]--></div><!--]!--><!--]--><!--]--><!--]--><!--]--><!--]--><!--]--> <a href="/" class="ml-2 rounded-md font-quicksand focus-visible:outline-none text-xl font-bold focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background">The Copenhagen Book</a></div> <div class="flex items-center justify-end gap-2.5"><!--[--><!--[--><!--[--><!--[--><button  type="button" tabindex="0" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-10 w-10" data-button-root=""><!--[--><!--[--><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-sun h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"><!--[--><!--[--><!--[--><circle  cx="12" cy="12" r="4"><!--[--><!--]--></circle><!--]--><!--]--><!--[--><!--[--><path  d="M12 2v2"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="M12 20v2"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="m4.93 4.93 1.41 1.41"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="m17.66 17.66 1.41 1.41"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="M2 12h2"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="M20 12h2"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="m6.34 17.66-1.41 1.41"><!--[--><!--]--></path><!--]--><!--]--><!--[--><!--[--><path  d="m19.07 4.93-1.41 1.41"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--> <!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-moon absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"><!--[--><!--[--><!--[--><path  d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--> <span class="sr-only">Change theme</span><!--]--><!--]--><!--]--></button><!--]--><!--]!--><!--]--><!--]--></div></div></div></header><!--]--> <div class="min-h-[calc(100vh-64px)]"><div class="container flex-1 items-start md:grid md:grid-cols-[220px_minmax(0,1fr)] md:gap-6 lg:grid-cols-[250px_minmax(0,1fr)] lg:gap-10"><!--[--><!--[--><aside class="fixed top-10 z-30 hidden h-[calc(100vh-3.5rem)] w-full shrink-0 overflow-y-auto border-r border-border md:sticky md:block"><div class="h-full py-6 pr-4 lg:py-8"><nav class="space-y-3"><div class="flex w-full flex-col pb-[50px]"><!--[--><!--[--><!--[--><!--[--><!--[--><div class="grid grid-flow-row auto-rows-max gap-0.5 pb-2 pl-4 text-sm"><!--[--><!--[--><!--[--><a href="/content/index" class="group flex w-full items-center gap-2.5 rounded-md px-2.5 py-1.5 text-sm font-semibold text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Introduction <!--[--><!--]!--></a><!--]--><!--]--><!--]--></div><!--]--><!--]--><!--]--><!--]--><!--[--><!--[--><div class="pb-4"><h4 class="mb-1 ml-[9px] rounded-md px-2.5 py-2 pl-4 text-xs font-medium uppercase text-muted-foreground">content</h4> <!--[--><!--[--><!--[--><div class="grid grid-flow-row auto-rows-max gap-0.5 pl-4 text-sm"><!--[--><!--[--><!--[--><a href="/content/server-side-tokens" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Server-side tokens <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/sessions" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Sessions <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/password-authentication" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background text-blue-600 dark:text-blue-500" target="" rel="">Password authentication <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/email-verification" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Email verification <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/password-reset" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Password reset <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/random-values" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Generating random values <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/oauth" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">OAuth <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/mfa" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Multi-factor authentication (MFA) <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/passkeys" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Passkeys <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/csrf" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Cross-site request forgery (CSRF) <!--[--><!--]!--></a><!--]--><!--]--><!--[--><!--[--><a href="/content/open-redirect" class="group inline-flex w-full items-center rounded-md px-2.5 py-1.5 text-foreground transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background hover:underline" target="" rel="">Open redirect <!--[--><!--]!--></a><!--]--><!--]--><!--]--></div><!--]--><!--]--><!--]--></div><!--]!--><!--]--><!--]--></div></nav></div></aside><!--]--><!--]--> <main class="relative pb-6 pl-4 pr-4 pt-16 md:pl-0 lg:gap-10 xl:grid-cols-[1fr_220px] xl:grid"><div class="mx-auto w-full min-w-0 md:max-w-[700px]" id="content"><!--[--><!--[--><!--[--><!--[--><!--[--><!--[--><h1 class="mt-2 scroll-m-20 text-4xl font-bold" id="password-authentication"><!--[-->Password authentication<!--]--></h1><!--]--> <!--[--><h2 class="mt-6 -scroll-m-36 text-[27px] font-semibold tracking-[-0.01em] first:mt-0" id="input-validation"><!--[-->Input validation<!--]--></h2><!--]--> <!--[--><ul class="ml-6 list-disc"><!--[--><!--[--><li class="mt-2"><!--[-->Passwords must be at least 8 characters long.<!--]--></li><!--]--> <!--[--><li class="mt-2"><!--[-->Do not set the maximum password length too low. Anywhere around 64-256 characters is a good maximum.<!--]--></li><!--]--> <!--[--><li class="mt-2"><!--[-->Do not silently modify or truncate the input.<!--]--></li><!--]--> <!--[--><li class="mt-2"><!--[-->All valid Unicode characters should be allowed, including whitespace.<!--]--></li><!--]--> <!--[--><li class="mt-2"><!--[-->Use libraries like <!--[--><a href="https://github.com/dropbox/zxcvbn" target="_blank" rel="noopener noreferrer" class="link text-blue-600 dark:text-blue-500"><!--[--><!--[--><code>zxcvbn</code><!--]--><!--]--></a><!--]--> to check for weak passwords.<!--]--></li><!--]--> <!--[--><li class="mt-2"><!--[-->Detect leaked passwords with APIs such as <!--[--><a href="https://haveibeenpwned.com/API/v3" target="_blank" rel="noopener noreferrer" class="link text-blue-600 dark:text-blue-500"><!--[-->haveibeenpwned<!--]--></a><!--]-->.<!--]--></li><!--]--><!--]--></ul><!--]--> <!--[--><h3 class="mt-6 scroll-m-20 text-xl font-semibold tracking-tight" id="checking-for-compromised-passwords"><!--[-->Checking for compromised passwords<!--]--></h3><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->A free service called <!--[--><a href="https://haveibeenpwned.com/API/v3" target="_blank" rel="noopener noreferrer" class="link text-blue-600 dark:text-blue-500"><!--[-->haveibeenpwned<!--]--></a><!--]--> can be used to check a password against past leaks. Hash the password with SHA-1 (hex-encoded) and send the first 5 characters.<!--]--></p><!--]--> <figure data-rehype-pretty-code-figure=""><!--[--><pre class="relative mb-4 mt-6 overflow-x-auto rounded-card border-2 border-muted py-8 Serendipity Midnight Serendipity Morning" tabindex="0" data-language="untype" data-theme="Serendipity Midnight Serendipity Morning">
	<!--[--><!--[--><code data-language="untype" data-theme="Serendipity Midnight Serendipity Morning" style="display: grid;"><span data-line=""><span>GET https://api.pwnedpasswords.com/range/12345</span></span></code><!--]--><!--]-->
	<!--[--><button class="z-20 inline-flex h-9 w-9 items-center justify-center rounded-md text-sm font-medium text-muted-foreground transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background absolute right-4 top-4" aria-label="Copy" data-copy-code="true"><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-copy h-5 w-5"><!--[--><!--[--><!--[--><rect  width="14" height="14" x="8" y="8" rx="2" ry="2"><!--[--><!--]--></rect><!--]--><!--]--><!--[--><!--[--><path  d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--><!--]!--></button><!--]-->
</pre><!--]--></figure> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->The API will provide a list of hashed password suffixes beginning with the provided 5 characters<!--]--></p><!--]--> <figure data-rehype-pretty-code-figure=""><!--[--><pre class="relative mb-4 mt-6 overflow-x-auto rounded-card border-2 border-muted py-8 Serendipity Midnight Serendipity Morning" tabindex="0" data-language="untype" data-theme="Serendipity Midnight Serendipity Morning">
	<!--[--><!--[--><code data-language="untype" data-theme="Serendipity Midnight Serendipity Morning" style="display: grid;"><span data-line=""><span>ec68dea7966a1ea2ba9408be4dcc409884f</span></span>
<span data-line=""><span>248b2dddf14a111b9d08b906d06224a0a79</span></span>
<span data-line=""><span>f10a49ecd2ada17a120dc359f162b84e12c</span></span></code><!--]--><!--]-->
	<!--[--><button class="z-20 inline-flex h-9 w-9 items-center justify-center rounded-md text-sm font-medium text-muted-foreground transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background absolute right-4 top-4" aria-label="Copy" data-copy-code="true"><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-copy h-5 w-5"><!--[--><!--[--><!--[--><rect  width="14" height="14" x="8" y="8" rx="2" ry="2"><!--[--><!--]--></rect><!--]--><!--]--><!--[--><!--[--><path  d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--><!--]!--></button><!--]-->
</pre><!--]--></figure> <!--[--><h2 class="mt-6 -scroll-m-36 text-[27px] font-semibold tracking-[-0.01em] first:mt-0" id="password-storage"><!--[-->Password storage<!--]--></h2><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Passwords must be salted and hashed before storage. We recommend using <!--[--><a href="#argon2id" class="link text-blue-600 dark:text-blue-500"><!--[-->Argon2id<!--]--></a><!--]--> with salting.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->In the most basic form, hashing is a one-way process to generate a unique representation of the input. The same input should result in the same hash. Unlike encryption, it is not reversible - you can't get the original data from the hash. Popular examples include MD5, SHA-1, and SHA-256 - <strong>DO NOT USE THESE FOR PASSWORDS</strong>.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Hashing ensures that if you suffer a data breach, hackers won't be able to get the original password. This is especially important if the breach is limited in scope. Even if they were only able to read the user table, they'll effectively have access to everything once they get hold of user passwords. More importantly, however, it protects your users from further harm. Users often reuse passwords. With leaked passwords, hackers can gain access to user accounts in other applications as well.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->However, a big issue with passwords is that they aren't truly random. Technically there are 62^8 possible 8-character alphanumeric passwords, but the reality is that most passwords use common words and names, maybe with some numbers at the end. This significantly reduces the number of combinations to test when brute-forcing passwords.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->As such, slow hashing algorithms specifically designed for passwords are used. Common hashing algorithms like SHA-256 are designed to be as fast as possible.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Even when using a slow algorithm, a table of precomputed hashes of common passwords called a rainbow table can be used. Salting is a common technique to prevent these attacks by adding random values to each password before hashing. The salt must be generated using a cryptographically-secure random generator and it should have at least 120 bits of entropy.<!--]--></p><!--]--> <figure data-rehype-pretty-code-figure=""><!--[--><pre class="relative mb-4 mt-6 overflow-x-auto rounded-card border-2 border-muted py-8 Serendipity Midnight Serendipity Morning" tabindex="0" data-language="untype" data-theme="Serendipity Midnight Serendipity Morning">
	<!--[--><!--[--><code data-language="untype" data-theme="Serendipity Midnight Serendipity Morning" style="display: grid;"><span data-line=""><span>salt = randomValues()</span></span>
<span data-line=""><span>hash = hashPassword(password + salt) + salt</span></span></code><!--]--><!--]-->
	<!--[--><button class="z-20 inline-flex h-9 w-9 items-center justify-center rounded-md text-sm font-medium text-muted-foreground transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background absolute right-4 top-4" aria-label="Copy" data-copy-code="true"><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-copy h-5 w-5"><!--[--><!--[--><!--[--><rect  width="14" height="14" x="8" y="8" rx="2" ry="2"><!--[--><!--]--></rect><!--]--><!--]--><!--[--><!--[--><path  d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--><!--]!--></button><!--]-->
</pre><!--]--></figure> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Another option is peppering where you use a secret key when hashing the password. Whereas salts are stored alongside the hashes, the secret key is stored in a separate location. Rolling your own hashing mechanism can be a bad idea so this should only be done if the algorithm you use supports it.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->When comparing password hashes, use constant time comparison instead of <!--[--><code>==</code><!--]-->. This ensures your application is not vulnerable to timing-based attacks, where an attacker can extract information using how long it took to compare the password with the hash.<!--]--></p><!--]--> <figure data-rehype-pretty-code-figure=""><!--[--><pre class="relative mb-4 mt-6 overflow-x-auto rounded-card border-2 border-muted py-8 Serendipity Midnight Serendipity Morning" tabindex="0" data-language="untype" data-theme="Serendipity Midnight Serendipity Morning">
	<!--[--><!--[--><code data-language="untype" data-theme="Serendipity Midnight Serendipity Morning" style="display: grid;"><span data-line=""><span>import (</span></span>
<span data-line=""><span>	"crypto/subtle"</span></span>
<span data-line=""><span>	"golang.org/x/crypto/argon2"</span></span>
<span data-line=""><span>)</span></span>
<span data-line=""> </span>
<span data-line=""><span>var storedHash []byte</span></span>
<span data-line=""><span>var password []byte</span></span>
<span data-line=""><span>hash := argon2.IDKey(password, salt, 2, 19*1024, 1, 32)</span></span>
<span data-line=""> </span>
<span data-line=""><span>if (subtle.ConstantTimeCompare(hash, storedHash)) &#123;</span></span>
<span data-line=""><span>	// Valid password.</span></span>
<span data-line=""><span>&#125;</span></span></code><!--]--><!--]-->
	<!--[--><button class="z-20 inline-flex h-9 w-9 items-center justify-center rounded-md text-sm font-medium text-muted-foreground transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-foreground focus-visible:ring-offset-2 focus-visible:ring-offset-background absolute right-4 top-4" aria-label="Copy" data-copy-code="true"><!--[--><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-copy h-5 w-5"><!--[--><!--[--><!--[--><rect  width="14" height="14" x="8" y="8" rx="2" ry="2"><!--[--><!--]--></rect><!--]--><!--]--><!--[--><!--[--><path  d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"><!--[--><!--]--></path><!--]--><!--]--><!--]--><!--[--><!--[--><!--]--><!--]--></svg><!--]--><!--]--><!--]!--></button><!--]-->
</pre><!--]--></figure> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Argon2id should be your first choice, followed by Scrypt, and then Bcrypt for legacy systems.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Password hashing is resource-intensive and is vulnerable to denial-of-service (DoS) attacks.<!--]--></p><!--]--> <!--[--><h3 class="mt-6 scroll-m-20 text-xl font-semibold tracking-tight" id="argon2id"><!--[-->Argon2id<!--]--></h3><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Argon2 was the winner of the 2013 Password Hashing Competition and has 3 versions: Argon2i, Argon2d, and Argon2id. Argon2id should be your default option as it provides a good balance between resisting both side-channel and GPU-based attacks. Recommended minimum parameters:<!--]--></p><!--]--> <!--[--><ul class="ml-6 list-disc"><!--[--><!--[--><li class="mt-2"><!--[--><!--[--><code>memorySize</code><!--]-->: 19456 (19 MB)<!--]--></li><!--]--> <!--[--><li class="mt-2"><!--[--><!--[--><code>iterations</code><!--]-->: 2<!--]--></li><!--]--> <!--[--><li class="mt-2"><!--[--><!--[--><code>parallelism</code><!--]-->: 1<!--]--></li><!--]--><!--]--></ul><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Optionally use the <!--[--><code>secret</code><!--]--> parameter to pepper your hashes. <!--[--><a href="https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html#argon2id" target="_blank" rel="noopener noreferrer" class="link text-blue-600 dark:text-blue-500"><!--[-->See OWASP for details<!--]--></a><!--]-->.<!--]--></p><!--]--> <!--[--><h3 class="mt-6 scroll-m-20 text-xl font-semibold tracking-tight" id="scrypt"><!--[-->Scrypt<!--]--></h3><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Recommended minimum parameters:<!--]--></p><!--]--> <!--[--><ul class="ml-6 list-disc"><!--[--><!--[--><li class="mt-2"><!--[--><!--[--><code>N</code><!--]-->: 16384<!--]--></li><!--]--> <!--[--><li class="mt-2"><!--[--><!--[--><code>P</code><!--]-->: 16<!--]--></li><!--]--> <!--[--><li class="mt-2"><!--[--><!--[--><code>r</code><!--]-->: 1<!--]--></li><!--]--> <!--[--><li class="mt-2"><!--[--><!--[--><code>dkLen</code><!--]-->: 64<!--]--></li><!--]--><!--]--></ul><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[--><!--[--><a href="https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html#scrypt" target="_blank" rel="noopener noreferrer" class="link text-blue-600 dark:text-blue-500"><!--[-->See OWASP for details<!--]--></a><!--]-->.<!--]--></p><!--]--> <!--[--><h3 class="mt-6 scroll-m-20 text-xl font-semibold tracking-tight" id="bcrypt"><!--[-->Bcrypt<!--]--></h3><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->The work factor should be at minimum a 10.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Bcrypt has a maximum input length of 72 bytes, and some implementations may have a limit as low as 50 bytes. Pre-hashing the password with algorithms like SHA-256/512 is not recommended as some implementations of Bcrypt are not built to handle null bytes. Do not attempt to implement peppering by using HMAC either. Use algorithms like <!--[--><a href="#argon2id" class="link text-blue-600 dark:text-blue-500"><!--[-->Argon2id<!--]--></a><!--]--> or <!--[--><a href="#scrypt" class="link text-blue-600 dark:text-blue-500"><!--[-->Scrypt<!--]--></a><!--]--> instead if you need to support longer passwords.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[--><!--[--><a href="https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html#bcrypt" target="_blank" rel="noopener noreferrer" class="link text-blue-600 dark:text-blue-500"><!--[-->See OWASP for details<!--]--></a><!--]-->.<!--]--></p><!--]--> <!--[--><h2 class="mt-6 -scroll-m-36 text-[27px] font-semibold tracking-[-0.01em] first:mt-0" id="brute-force-attacks"><!--[-->Brute-force attacks<!--]--></h2><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Passwords are susceptible to brute-force attacks. There are mainly 2 approaches to brute-forcing:<!--]--></p><!--]--> <!--[--><ol class="my-6 ml-6 list-decimal"><!--[--><!--[--><li class="mt-2"><!--[-->The attacker tries a bunch of common passwords.<!--]--></li><!--]--> <!--[--><li class="mt-2"><!--[-->The attacker targets specific accounts using leaked passwords (credential stuffing).<!--]--></li><!--]--><!--]--></ol><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[--><!--[--><a href="/content/mfa" class="link text-blue-600 dark:text-blue-500"><!--[-->Multi-factor authentication (MFA)<!--]--></a><!--]--> is the best defense against brute-force attacks. While it doesn't prevent brute-force attacks themselves, it does make it nearly pointless to do. Users should be recommended to enable MFA and it should be required for security-critical applications.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->IP-based throttling should always be implemented. A basic example is to block all attempts from an IP address for 10 minutes after they fail 10 consecutive attempts. Other ideas include increasing the lockout period on each lockout and gradually allowing new attempts at a set interval after a lockout. This also prevents DOS attacks as password hashing is resource-intensive. An identifier-based throttling can also be implemented on top of IP-based throttling, though this can introduce DoS vulnerabilities (see <!--[--><a href="https://owasp.org/www-community/Slow_Down_Online_Guessing_Attacks_with_Device_Cookies" target="_blank" rel="noopener noreferrer" class="link text-blue-600 dark:text-blue-500"><!--[-->device cookies<!--]--></a><!--]-->).<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Another layer of security you can implement is bot detection using tests like Captchas.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->Finally, ensure a certain strength of passwords for users. Make sure passwords aren't weak and that they haven't been part of previous leaks.<!--]--></p><!--]--> <!--[--><h2 class="mt-6 -scroll-m-36 text-[27px] font-semibold tracking-[-0.01em] first:mt-0" id="error-handling"><!--[-->Error handling<!--]--></h2><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->As a good rule of thumb, error messages should be vague and generic. For example, a login form should display "Incorrect username or password" instead of "Incorrect username" or "Incorrect password." Similarly, a sign-in form shouldn't share whether a email is already used by an existing account.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->However, from a user-experience perspective, it's more user-friendly to tell the user directly that their username or email is incorrect. This should be fine for websites where usernames are already public (e.g. social media) or where knowing the validity of a email isn't important (i.e. most sites). This makes brute-force attacks slightly easier since attackers only need to guess passwords, but you should already have <!--[--><a href="#brute-force-attacks" class="link text-blue-600 dark:text-blue-500"><!--[-->proper measures<!--]--></a><!--]--> implemented.<!--]--></p><!--]--> <!--[--><p class="leading-7 [&amp;:not(:first-child)]:mt-2"><!--[-->If you need to keep the username or email private, make sure you do not leak such information via registration forms and password reset forms. For example, when creating an account, you can prompt the user with a message like "We've sent an email to your inbox with further instructions" regardless of whether the email is taken. If they already have an account, you can include that information in the email itself. Even when returning a generic message however, it may be possible to determine if a user exists or not by checking the response times. For example, if you only validate the password when the username is valid. Protecting against timing-attacks is hard so only go this route if strictly required.<!--]--></p><!--]--> <!--[--><h2 class="mt-6 -scroll-m-36 text-[27px] font-semibold tracking-[-0.01em] first:mt-0" id="other-considerations"><!--[-->Other considerations<!--]--></h2><!--]--> <!--[--><ul class="ml-6 list-disc"><!--[--><!--[--><li class="mt-2"><!--[-->Do not prevent users from copy-pasting passwords as it discourages users from using password managers.<!--]--></li><!--]--> <!--[--><li class="mt-2"><!--[-->Ask for the current password when a user attempts to change their password.<!--]--></li><!--]--> <!--[--><li class="mt-2"><!--[--><!--[--><a href="/content/open-redirect" class="link text-blue-600 dark:text-blue-500"><!--[-->Open redirect<!--]--></a><!--]-->.<!--]--></li><!--]--><!--]--></ul><!--]--><!--]--><!--]--><!--]--><!--]--><!--]--></div> <!--[--><div class="hidden text-sm xl:block"><div class="sticky top-16 -mt-10 h-[calc(100vh-3.5rem)] overflow-hidden pt-6"><!--[--><div class="mt-1 overflow-y-auto rounded-lg p-4"><nav><!--[--><!--[--><ul class="m-0 list-none"><!--[--><!--]!--></ul><!--]--><!--]--></nav></div><!--]--></div></div><!--]--></main></div></div><!--]--><!--]--> <!--[--><!--]!--><!--]-->
			
			<script>
				{
					__sveltekit_rpkwke = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					const data = [null,null];

					Promise.all([
						import("../_app/immutable/entry/start.Ckx-DEvp.js"),
						import("../_app/immutable/entry/app.HqDmpUJI.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 3],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
<!--- /\_/\ --->
<!---( o.o )--->
<!--- > ^ < --->
